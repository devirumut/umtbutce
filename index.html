<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bütçe Planlama Uygulaması V5.2</title>

  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    script-src 'self' https://accounts.google.com;
    style-src 'self' https://fonts.googleapis.com;
    font-src https://fonts.gstatic.com;
    img-src 'self' data: https://www.gstatic.com https://lh3.googleusercontent.com;
    connect-src 'self' https://www.googleapis.com https://oauth2.googleapis.com;
    frame-src https://www.altinkaynak.com;
    base-uri 'self';
    form-action 'self';
    object-src 'none';
    frame-ancestors 'none';
    upgrade-insecure-requests;
  " />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- SELF-HOSTED vendor libs -->
  <script src="assets/vendor/chart.umd.min.js" defer></script>
  <script src="assets/vendor/html2pdf.bundle.min.js" defer></script>

  <!-- Google Identity Services -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <link rel="stylesheet" href="assets/app.css" />
  <script src="assets/app.js" defer></script>
</head>

<body>
  <div class="app-header">
    <div class="header-left">
      <h1 class="app-title">
        Bütçe Planlama <span class="app-ver">V5.2</span>
      </h1>
      <div id="user-info" class="user-info" style="display:none;">
        <img id="user-img" alt="user" src="" class="user-img">
        <span id="user-email" class="user-email"></span>
      </div>
    </div>

    <div class="header-right">
      <button id="auth_btn" class="google-btn" type="button">
        <img src="https://www.gstatic.com/images/branding/product/1x/gsa_512dp.png" alt="Google"> Google ile Bağlan
      </button>

      <div id="auth_controls" class="auth-controls" style="display:none;">
        <span id="session_badge" class="chip" style="display:none;">
          <span class="chip-dot">.</span>
          <span id="session_countdown">15:00</span>
          <span id="session_state" class="chip-state">ACTIVE</span>
        </span>
        <button id="btn_backup" class="btn btn-green" type="button">Yedekle</button>
        <button id="btn_logout" class="btn btn-gray" type="button">Çıkış</button>
      </div>

      <button id="btn_theme" type="button" class="btn btn-tool">Tema</button>
    </div>
  </div>

  <div class="main-layout">
    <div class="left-panel">
      <div class="widget-card">
        <div class="widget-header">24 AYAR GRAM</div>
        <div class="crop-box">
          <iframe
            src="https://www.altinkaynak.com/canli-kurlar/altin"
            id="frame-gram"
            loading="lazy"
            referrerpolicy="no-referrer"
            sandbox="allow-scripts allow-same-origin"></iframe>
        </div>
      </div>

      <div class="widget-card">
        <div class="widget-header">ÇEYREK ALTIN</div>
        <div class="crop-box">
          <iframe
            src="https://www.altinkaynak.com/canli-kurlar/altin"
            id="frame-ceyrek"
            loading="lazy"
            referrerpolicy="no-referrer"
            sandbox="allow-scripts allow-same-origin"></iframe>
        </div>
      </div>

      <div class="widget-card">
        <div class="widget-header">DOLAR & EURO</div>
        <div class="crop-box currency-box">
          <iframe
            src="https://www.altinkaynak.com/canli-kurlar/doviz"
            id="frame-doviz"
            loading="lazy"
            referrerpolicy="no-referrer"
            sandbox="allow-scripts allow-same-origin"></iframe>
        </div>
      </div>
    </div>

    <div class="budget-card">
      <div class="sticky-controls">
        <div class="top-row">
          <div class="month-nav">
            <button id="btn_prev" type="button" class="btn">Prev</button>
            <span id="display-month" class="display-month"></span>
            <button id="btn_next" type="button" class="btn">Next</button>
          </div>

          <div class="toolbar">
            <button id="btn_search" type="button" class="btn btn-tool" title="Ara / Filtre">Ara</button>
            <button id="btn_yearly" type="button" class="btn btn-tool">Yıllık</button>
            <button id="btn_chart" type="button" class="btn btn-tool">Analiz</button>
            <button id="btn_pdf" type="button" class="btn btn-tool">PDF</button>
            <button id="btn_settings" type="button" class="btn btn-tool">Ayarlar</button>
          </div>
        </div>

        <div class="muted" id="progress-text">HARCAMA ORANI: %0</div>
        <div class="progress-wrap"><div id="progress-fill" class="progress-fill"></div></div>

        <div class="quick-add">
          <input id="quick_input" placeholder="Hızlı ekle: 'kira 8500 5 gider' / 'maaş 45000 1 gelir'">
          <button id="btn_quick_add" class="btn" type="button">Hızlı Ekle</button>
        </div>

        <div id="search_panel" class="control-bar" style="display:none;">
          <input id="f_search" placeholder="Ara (isim/etiket)">
          <select id="f_type">
            <option value="all">Tür: Hepsi</option>
            <option value="gelir">Tür: Gelir</option>
            <option value="gider">Tür: Gider</option>
          </select>
          <select id="f_status">
            <option value="all">Durum: Hepsi</option>
            <option value="paid">Durum: Ödendi/Alındı</option>
            <option value="pending">Durum: Bekliyor</option>
            <option value="overdue">Durum: Gecikti</option>
          </select>
          <select id="f_cat">
            <option value="all">Kategori: Hepsi</option>
          </select>
          <select id="f_sort">
            <option value="day_asc">Sırala: Gün ↑</option>
            <option value="day_desc">Sırala: Gün ↓</option>
            <option value="amt_desc">Sırala: Tutar ↓</option>
            <option value="amt_asc">Sırala: Tutar ↑</option>
            <option value="name_asc">Sırala: İsim A-Z</option>
          </select>
        </div>
      </div>

      <div class="entry-head">
        <div></div><div>İşlem</div><div>Tutar</div><div>Tür</div><div>Kategori</div><div>Gün</div><div>Tekrar</div><div>Durum</div><div></div>
      </div>
      <div id="entries-container"></div>

      <button id="btn_add" type="button" class="btn btn-add-row">
        Yeni İşlem
      </button>

      <div class="summary-grid">
        <div class="stat"><small>GELİR (ALINAN)</small><div class="val val-inc" id="t-inc">0 TL</div></div>
        <div class="stat"><small>GELİR (BEKLEYEN)</small><div class="val val-incp" id="t-incp">0 TL</div></div>
        <div class="stat"><small>GİDER (ÖDENEN)</small><div class="val val-exp" id="t-exp">0 TL</div></div>
        <div class="stat"><small>GİDER (BEKLEYEN)</small><div class="val val-pend" id="t-pend">0 TL</div></div>
        <div class="stat net"><small>NET (TAHMİNİ)</small><div class="val" id="t-net">0 TL</div></div>
      </div>
    </div>
  </div>

  <div class="calendar-section">
    <div class="calendar-title">Ödeme Takvimi</div>
    <div class="calendar-grid" id="calendar-body"></div>
  </div>

  <div class="footer">umtdvr</div>

  <!-- ANALIZ MODAL -->
  <div id="chartModal" class="modal-overlay">
    <div class="modal">
      <button class="closex" type="button" data-close="chartModal">x</button>
      <h3 class="modal-title">Analiz</h3>

      <div class="tabs">
        <div class="tab active" data-tab="tab-month">Aylık Dağılım</div>
        <div class="tab" data-tab="tab-trend">Trend (12 Ay)</div>
        <div class="tab" data-tab="tab-cats">Kategori</div>
      </div>

      <div class="tabpane active" id="tab-month">
        <div class="chart-wrap"><canvas id="chart_month"></canvas></div>
        <div class="muted">Net negatifse grafikte 0 gösterilir.</div>
      </div>

      <div class="tabpane" id="tab-trend">
        <div class="chart-wrap chart-tall"><canvas id="chart_trend"></canvas></div>
        <div class="muted">Gerçekleşen: paid. Tahmin: paid + pending.</div>
      </div>

      <div class="tabpane" id="tab-cats">
        <div class="chart-wrap"><canvas id="chart_cat"></canvas></div>
        <div class="muted">Sadece giderler kategori bazlı gösterilir (paid + pending).</div>
      </div>
    </div>
  </div>

  <!-- SETTINGS MODAL -->
  <div id="settingsModal" class="modal-overlay">
    <div class="modal">
      <button class="closex" type="button" data-close="settingsModal">x</button>
      <h3 class="modal-title">Ayarlar</h3>

      <div class="settings-top">
        <button id="btn_undo" class="btn btn-tool" type="button">Geri Al</button>
        <button id="btn_notify" class="btn btn-tool" type="button">Bildirim İzni</button>
        <button id="btn_sync" class="btn btn-tool" type="button">Buluttan Çek</button>
      </div>

      <hr class="hr">

      <div class="section-label">KATEGORİLER</div>
      <div class="cat-add">
        <input id="cat_input" placeholder="Yeni kategori adı">
        <button id="btn_add_cat" class="btn" type="button">Ekle</button>
      </div>
      <div id="cat_list" class="cat-list"></div>

      <hr class="hr">

      <div class="critical">
        <div class="critical-title">KRİTİK</div>
        <div class="critical-desc">Yerel verileri sıfırlar. Bulut yedeği varsa geri alınabilir.</div>
        <button id="btn_reset" class="btn btn-danger critical-btn" type="button">Yerel Verileri Sıfırla</button>
      </div>
    </div>
  </div>

  <!-- YEARLY MODAL -->
  <div id="yearlyModal" class="modal-overlay">
    <div class="modal">
      <button class="closex" type="button" data-close="yearlyModal">x</button>
      <h3 id="yearly-title" class="modal-title">Yıllık Özet</h3>
      <div id="yearly-content"></div>
    </div>
  </div>
</body>
</html>
