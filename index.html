<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bütçe Planlama Uygulaması V5.3</title>

  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />

  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://accounts.google.com;
    style-src  'self' 'unsafe-inline' https://fonts.googleapis.com https://fonts.gstatic.com;
    font-src https://fonts.gstatic.com;
    img-src 'self' data: https://www.gstatic.com https://lh3.googleusercontent.com;
    connect-src 'self' https://www.googleapis.com https://oauth2.googleapis.com;
    frame-src https://www.altinkaynak.com;
    upgrade-insecure-requests;
  " />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" defer></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <style>
    :root{
      --primary:#f8fafc; --card-bg:#ffffff; --accent:#4f46e5;
      --income:#22c55e; --expense:#f43f5e; --pending:#f59e0b; --overdue:#ef4444;
      --text-main:#1e293b; --text-dim:#64748b; --border:#e2e8f0; --header-bg:#f1f5f9;
      --shadow:0 10px 40px rgba(0,0,0,0.04);
    }
    [data-theme="dark"]{
      --primary:#0f172a; --card-bg:#1e293b; --accent:#818cf8;
      --text-main:#f1f5f9; --text-dim:#94a3b8; --border:#334155; --header-bg:#334155;
    }

    /* Ikon Ayarı */
    .mi {
      font-family: 'Material Symbols Rounded';
      font-weight: normal; font-style: normal; font-size: 20px;
      line-height: 1; display: inline-block; white-space: nowrap;
      vertical-align: middle;
    }

    body{ font-family:'Poppins', sans-serif; background:var(--primary); color:var(--text-main); margin:0; padding:10px; display:flex; flex-direction:column; align-items:center; }
    .hidden{ display:none !important; }

    .app-header{
      width:100%; max-width:1750px; display:flex; justify-content:space-between; align-items:center;
      padding:10px 25px; background:var(--card-bg); border-radius:15px; margin-bottom:15px;
      box-shadow:var(--shadow); border:1px solid var(--border);
    }

    .header-right{ display:flex; align-items:center; gap:12px; }

    /* Oturum Rozeti */
    .session-badge {
      display: flex; align-items: center; gap: 8px; background: var(--header-bg);
      padding: 6px 12px; border-radius: 12px; border: 1px solid var(--border);
      font-size: 11px; font-weight: 700;
    }
    .status-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--pending); box-shadow: 0 0 5px var(--pending); }
    .active .status-dot { background: var(--income); box-shadow: 0 0 8px var(--income); }

    .btn{
      background:var(--accent); color:#fff; border:none; padding:8px 14px; border-radius:10px;
      font-weight:700; cursor:pointer; font-size:12px; display:inline-flex; align-items:center; gap:6px; transition:.2s;
    }
    .btn-tool{ background:var(--header-bg); color:var(--text-main); border:1px solid var(--border); }
    .btn-danger{ background:var(--expense) !important; }
    .btn-green{ background:var(--income) !important; }

    .main-layout{ width:100%; max-width:1750px; display:grid; grid-template-columns:300px 1fr; gap:20px; }
    
    /* Sol Paneli Sabit Tutuyoruz */
    .left-panel{ display:flex; flex-direction:column; gap:10px; width: 300px; }
    .widget-card{ background:var(--card-bg); border-radius:12px; border:1px solid var(--border); overflow:hidden; }
    .widget-header{ background:var(--header-bg); padding:8px 15px; font-size:.7rem; font-weight:800; color:var(--text-dim); }
    .crop-box{ height:42px; overflow:hidden; position:relative; background:#fff; }
    .currency-box{ height:78px; }
    .crop-box iframe{ border:none; width:2400px; height:5000px; position:absolute; transform:scale(.63); transform-origin:0 0; }
    #frame-gram{ top:-260px; left:-25px; }
    #frame-ceyrek{ top:-182px; left:-775px; }
    #frame-doviz{ top:-184px; left:-25px; }

    .budget-card{ background:var(--card-bg); padding:20px; border-radius:20px; border:1px solid var(--border); box-shadow:var(--shadow); }
    
    .entry-row { display: grid; grid-template-columns: 45px 1.2fr .6fr .5fr .7fr .4fr .6fr .6fr 45px; gap: 8px; align-items: center; margin-bottom: 8px; }
    .icon-box { width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 10px; background: var(--primary); border: 1px solid var(--border); }
  </style>
</head>
<body>

  <div class="app-header">
    <div class="header-left" style="display:flex; align-items:center; gap:15px;">
      <h1 style="font-size:1.2rem; margin:0; font-weight:900;">Bütçe <span style="opacity:0.5; font-size:10px;">V5.3</span></h1>
      <div id="user-info" class="hidden" style="display:flex; align-items:center; gap:8px;">
        <img id="user-img" src="" style="width:30px; border-radius:50%; border:2px solid var(--accent);">
        <span id="user-email" style="font-size:11px; font-weight:700;"></span>
      </div>
    </div>

    <div class="header-right">
      <div id="auth_controls" class="hidden" style="display:flex; align-items:center; gap:10px;">
        <div class="session-badge active" id="session_badge">
          <span class="status-dot"></span>
          <span id="session_countdown">15:00</span>
          <span id="session_state_text">ACTIVE</span>
        </div>
        <button id="btn_backup" class="btn btn-green"><span class="mi">cloud_upload</span> Yedekle</button>
        <button id="btn_logout" class="btn btn-danger"><span class="mi">logout</span> Çıkış</button>
      </div>
      <button id="auth_btn" class="btn"><span class="mi">account_circle</span> Google ile Bağlan</button>
      <button id="btn_theme" class="btn btn-tool"><span class="mi">dark_mode</span></button>
    </div>
  </div>

  <div class="main-layout">
    <div class="left-panel">
      <div class="widget-card">
        <div class="widget-header">24 AYAR GRAM</div>
        <div class="crop-box"><iframe src="https://www.altinkaynak.com/canli-kurlar/altin" id="frame-gram"></iframe></div>
      </div>
      <div class="widget-card">
        <div class="widget-header">ÇEYREK ALTIN</div>
        <div class="crop-box"><iframe src="https://www.altinkaynak.com/canli-kurlar/altin" id="frame-ceyrek"></iframe></div>
      </div>
      <div class="widget-card">
        <div class="widget-header">DOLAR & EURO</div>
        <div class="crop-box currency-box"><iframe src="https://www.altinkaynak.com/canli-kurlar/doviz" id="frame-doviz"></iframe></div>
      </div>
    </div>

    <div class="budget-card">
      <div style="display:flex; justify-content:space-between; margin-bottom:20px;">
        <div style="display:flex; align-items:center; gap:10px;">
          <button id="btn_prev" class="btn btn-tool"><span class="mi">arrow_back_ios</span></button>
          <span id="display-month" style="font-weight:900; font-size:1.1rem; min-width:140px; text-align:center;"></span>
          <button id="btn_next" class="btn btn-tool"><span class="mi">arrow_forward_ios</span></button>
        </div>
        <div style="display:flex; gap:8px;">
          <button id="btn_search" class="btn btn-tool"><span class="mi">search</span> Ara</button>
          <button id="btn_chart" class="btn btn-tool"><span class="mi">bar_chart</span> Analiz</button>
          <button id="btn_pdf" class="btn btn-tool"><span class="mi">picture_as_pdf</span> PDF</button>
          <button id="btn_settings" class="btn btn-tool"><span class="mi">settings</span></button>
        </div>
      </div>

      <div id="entries-container">
        </div>

      <button id="btn_add" class="btn btn-tool" style="width:100%; margin-top:15px; border: 1px dashed var(--accent); justify-content:center;">
        <span class="mi">add_circle</span> Yeni İşlem Ekle
      </button>
    </div>
  </div>

  <script>
    // JS tarafında "idle" yazısını ve ikonları yönetmek için şu güncellemeyi yapmalısın:
    function updateSessionUI(state) {
      const badge = document.getElementById('session_badge');
      const text = document.getElementById('session_state_text');
      if(state === 'idle') {
        badge.classList.remove('active');
        text.textContent = 'BEKLEMEDE';
      } else {
        badge.classList.add('active');
        text.textContent = 'AKTİF';
      }
    }
  </script>
</body>
</html>
